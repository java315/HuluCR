# 组件介绍

## 伤害组件

`DamageComponent`继承自`IntegerComponent`，用于描述一种攻击方式的伤害数值，在碰撞检测中将被用于计算被攻击者剩余的血量

## 生命组件

`HealthComponent`继承自`IntegerComponent`，用于表示一个`Monster`的血量。另外还会为其实体创建**血量条**，用于实时显示当前血量

## 身份组件

`IdentityComponent`继承自`BooleanComponent`，用于表示一个`Monster`的身份，并重载了`onAdded`方法，在组件被加入时，根据怪物身份设置怪物的朝向

## 传感器组件

`SensorComponent`用于怪物AI感知周围的敌方目标，并标记感知范围内最近的一个Monster为攻击对象

## AI

### MonsterAIComponent

AI组件的基类，要求具有状态组件和传感器组件，并会懒加载攻击方法

```java
public class MonsterAICompenonet extends Component {

    protected StateComponent stateComponent;
    protected SensorComponent sensorComponent;
    protected AttackMethod attackMethod;
    protected String name;

    @Override
    public void onAdded() {
        bindAttackMethod();
    }

    protected void bindAttackMethod(){
        entity.getComponents().stream().filter(c -> c instanceof AttackMethod).findFirst().ifPresent(a -> {
            attackMethod = (AttackMethod) a;
        });
    }
}
```

### MovableMonsterComponent

可移动AI组件，继承自`MonsterAIComponent`，实现了怪物的寻路、感知、攻击等行为

需要实体具备AStarMoveComponent(A*寻路组件)、StateCmponent、SensorComponent

```java
@Required(AStarMoveComponent.class)
@Required(StateComponent.class)
@Required(SensorComponent.class)
```

定义了`WALK`和`ATTACK`两个状态，初始状态为`WALK`,通过AStarMoveComponent进行寻塔，在通过传感器感知到敌方单位时进行状态切换为`ATTACK`，并调用攻击方式向传感器感知到的目标发起攻击

### UnmovableMonsterComponent

不可移动AI组件，用于塔的AI，继承自`MonsterAIComponent`，实现了塔的感知、攻击等行为

需要实体具备StateComponent和SensorComponent

```java
@Required(StateComponent.class)
@Required(SensorComponent.class)
```

定义了`GUARD`和`ATTACK`两个状态，初始状态为`GUARD`，通过传感器感知到敌方单位时进行状态切换为`ATTACK`，并调用攻击方式向传感器感知到的目标发起攻击

